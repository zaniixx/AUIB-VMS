{% extends 'base.html' %}
{% import '_macros.html' as ui %}

{% block title %}Admin Dashboard{% endblock %}

{% block body %}
<div class="container" style="padding-top: var(--space-6); padding-bottom: var(--space-6);">
  
  <!-- Page Header -->
  <div style="margin-bottom: var(--space-6);">
    <h1 class="text-3xl" style="margin-bottom: var(--space-2);">Admin Dashboard</h1>
    <p class="text-muted">System overview and management tools.</p>
  </div>

  <!-- Quick Stats Cards -->
  <div style="margin-bottom: var(--space-8); display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: var(--space-4);">
    
    <div class="card">
      <div class="card__body" style="text-align: center;">
        <div class="text-3xl font-semibold" style="color: var(--color-primary-600); margin-bottom: var(--space-2);">{{ users }}</div>
        <div class="text-lg font-medium" style="margin-bottom: var(--space-1);">Total Users</div>
        <div class="text-sm text-muted">Registered volunteers and staff</div>
      </div>
    </div>

    <div class="card">
      <div class="card__body" style="text-align: center;">
        <div class="text-3xl font-semibold" style="color: var(--color-success-600); margin-bottom: var(--space-2);">{{ events }}</div>
        <div class="text-lg font-medium" style="margin-bottom: var(--space-1);">Active Events</div>
        <div class="text-sm text-muted">Volunteer opportunities</div>
      </div>
    </div>

    <div class="card">
      <div class="card__body" style="text-align: center;">
        <div class="text-3xl font-semibold" style="color: var(--color-info-600); margin-bottom: var(--space-2);">{{ emails }}</div>
        <div class="text-lg font-medium" style="margin-bottom: var(--space-1);">Email Logs</div>
        <div class="text-sm text-muted">System communications</div>
      </div>
    </div>

  </div>

  <!-- Management Actions -->
  <div class="card">
    <div class="card__header">
      <h2 class="text-xl font-semibold">Management Tools</h2>
    </div>
    <div class="card__body">
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: var(--space-4);">
        
        <div class="card card--bordered">
          <div class="card__body">
            <h3 class="text-lg font-medium" style="margin-bottom: var(--space-2);">User Management</h3>
            <p class="text-sm text-muted" style="margin-bottom: var(--space-4);">Manage user accounts, roles, and permissions.</p>
            <div style="display: flex; gap: var(--space-2);">
              <a href="{{ url_for('admin.users') }}" class="btn btn--primary">Manage Users</a>
              <a href="{{ url_for('admin.users_by_role') }}" class="btn btn--secondary">Users by Role</a>
            </div>
          </div>
        </div>

        <div class="card card--bordered">
          <div class="card__body">
            <h3 class="text-lg font-medium" style="margin-bottom: var(--space-2);">System Settings</h3>
            <p class="text-sm text-muted" style="margin-bottom: var(--space-4);">Configure email settings and system preferences.</p>
            <div style="display: flex; gap: var(--space-2);">
              <a href="{{ url_for('admin.settings') }}" class="btn btn--primary">Mail Settings</a>
              <a href="{{ url_for('admin.settings_history') }}" class="btn btn--secondary">Settings History</a>
            </div>
          </div>
        </div>

        <div class="card card--bordered">
          <div class="card__body">
            <h3 class="text-lg font-medium" style="margin-bottom: var(--space-2);">Communication Logs</h3>
            <p class="text-sm text-muted" style="margin-bottom: var(--space-4);">Monitor email delivery and system notifications.</p>
            <a href="{{ url_for('admin.email_logs') }}" class="btn btn--primary">View Email Logs</a>
          </div>
        </div>

        <div class="card card--bordered">
          <div class="card__body">
            <h3 class="text-lg font-medium" style="margin-bottom: var(--space-2);">View As Feature</h3>
            <p class="text-sm text-muted" style="margin-bottom: var(--space-4);">Test the system from different user perspectives.</p>
            <div style="display: flex; gap: var(--space-2);">
              <button type="button" class="btn btn--secondary" onclick="toggleViewAs()">View As</button>
              {% if session.get('effective_role') %}
                <span class="badge badge--info">Viewing as {{ session.effective_role }}</span>
              {% endif %}
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- Recent Activity Section -->
  <div style="margin-top: var(--space-8);">
    <h2 class="text-2xl font-semibold" style="margin-bottom: var(--space-4);">Quick Actions</h2>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--space-4);">
      
      <a href="{{ url_for('officer.create_event') }}" class="card card--interactive">
        <div class="card__body" style="text-align: center;">
          <div class="text-2xl" style="margin-bottom: var(--space-2);">üìÖ</div>
          <div class="font-medium">Create Event</div>
          <div class="text-sm text-muted">Set up volunteer opportunities</div>
        </div>
      </a>

      <a href="{{ url_for('officer.approvals') }}" class="card card--interactive">
        <div class="card__body" style="text-align: center;">
          <div class="text-2xl" style="margin-bottom: var(--space-2);">‚úÖ</div>
          <div class="font-medium">Review Submissions</div>
          <div class="text-sm text-muted">Approve volunteer hours</div>
        </div>
      </a>

      <a href="{{ url_for('officer.pending_timelogs') }}" class="card card--interactive">
        <div class="card__body" style="text-align: center;">
          <div class="text-2xl" style="margin-bottom: var(--space-2);">‚è±Ô∏è</div>
          <div class="font-medium">Timelog Approvals</div>
          <div class="text-sm text-muted">Individual time entries</div>
        </div>
      </a>

      <a href="{{ url_for('officer.reports') }}" class="card card--interactive">
        <div class="card__body" style="text-align: center;">
          <div class="text-2xl" style="margin-bottom: var(--space-2);">üìä</div>
          <div class="font-medium">Generate Reports</div>
          <div class="text-sm text-muted">Volunteer hour summaries</div>
        </div>
      </a>

    </div>
  </div>

</div>

<script>
function toggleViewAs() {
  // Simple view-as toggle - in a real implementation this would open a modal
  // or redirect to a proper view-as endpoint
  alert('View-as feature would open a role selection interface here.');
}
</script>
{% endblock %}
