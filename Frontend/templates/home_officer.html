{% extends 'base.html' %}
{% import '_macros.html' as ui %}

{% block title %}Officer Dashboard{% endblock %}

{% block body %}
<div class="content-wrapper">
  <div style="margin-bottom: var(--space-8);">
    <h1 style="margin-bottom: var(--space-2);">Officer Dashboard</h1>
    <p style="color: var(--color-gray-600);">
      Manage events, approve volunteer requests, and oversee the volunteer program.
    </p>
  </div>

  <!-- Statistics Overview -->
  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--space-4); margin-bottom: var(--space-8);">
    {% call ui.card(compact=true) %}
      <div style="text-align: center;">
        <div style="font-size: var(--text-3xl); font-weight: var(--font-bold); color: var(--color-primary); margin-bottom: var(--space-1);">
          {{ pending_count }}
        </div>
        <div style="font-size: var(--text-sm); color: var(--color-gray-600);">
          Pending Approvals
        </div>
      </div>
    {% endcall %}

    {% call ui.card(compact=true) %}
      <div style="text-align: center;">
        <div style="font-size: var(--text-3xl); font-weight: var(--font-bold); color: var(--color-success); margin-bottom: var(--space-1);">
          {{ active_events }}
        </div>
        <div style="font-size: var(--text-sm); color: var(--color-gray-600);">
          Active Events
        </div>
      </div>
    {% endcall %}

    {% call ui.card(compact=true) %}
      <div style="text-align: center;">
        <div style="font-size: var(--text-3xl); font-weight: var(--font-bold); color: var(--color-info); margin-bottom: var(--space-1);">
          {{ total_events }}
        </div>
        <div style="font-size: var(--text-sm); color: var(--color-gray-600);">
          Total Events Created
        </div>
      </div>
    {% endcall %}
  </div>

  <!-- Quick Actions Grid -->
  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: var(--space-6); margin-bottom: var(--space-8);">
    <!-- Create Event Card -->
    {% call ui.card(title='Create Event', compact=true) %}
      <p style="color: var(--color-gray-600); font-size: var(--text-sm); margin-bottom: var(--space-4);">
        Set up new volunteer opportunities with manual entry and volunteer limits.
      </p>
      <a href="{{ url_for('officer.create_event') }}" class="btn btn--primary btn--full">
        <i class="fas fa-plus" style="width: 1.25rem; height: 1.25rem;"></i>
        Create New Event
      </a>
    {% endcall %}

    <!-- Approvals Card -->
    {% call ui.card(title='Approvals', compact=true) %}
      <p style="color: var(--color-gray-600); font-size: var(--text-sm); margin-bottom: var(--space-4);">
        Manage all pending approvals and submissions.
        {% if (pending_bulk_submissions_count + pending_timelogs_count + pending_event_requests_count) > 0 %}
          <strong style="color: var(--color-primary);">{{ pending_bulk_submissions_count + pending_timelogs_count + pending_event_requests_count }} items need your attention.</strong>
        {% endif %}
      </p>
      <div style="display: flex; flex-direction: column; gap: var(--space-2);">
        <a href="{{ url_for('officer.approvals') }}" class="btn btn--secondary btn--full">
          <i class="fas fa-inbox" style="width: 1.25rem; height: 1.25rem;"></i>
          Bulk Submissions ({{ pending_bulk_submissions_count }})
        </a>
        <a href="{{ url_for('officer.timelogs') }}" class="btn btn--primary btn--full">
          <i class="fas fa-check-circle" style="width: 1.25rem; height: 1.25rem;"></i>
          Hour Submissions ({{ pending_timelogs_count }})
        </a>
        <a href="{{ url_for('officer.event_requests') }}" class="btn btn--primary btn--full">
          <i class="fas fa-check-circle" style="width: 1.25rem; height: 1.25rem;"></i>
          Event Requests ({{ pending_event_requests_count }})
        </a>
      </div>
    {% endcall %}

    <!-- Recent Events Card -->
    {% call ui.card(title='Recent Events', compact=true) %}
      <p style="color: var(--color-gray-600); font-size: var(--text-sm); margin-bottom: var(--space-4);">
        View and manage your recently created events.
      </p>
      {% if recent_events %}
        <div style="margin-bottom: var(--space-4);">
          {% for event in recent_events %}
            <div style="display: flex; justify-content: space-between; align-items: center; padding: var(--space-2) 0; border-bottom: 1px solid var(--color-gray-200);">
              <div>
                <div style="font-weight: var(--font-medium); font-size: var(--text-sm);">{{ event.name }}</div>
                <div style="font-size: var(--text-xs); color: var(--color-gray-500);">{{ event.display_date }}</div>
              </div>
              <a href="{{ url_for('officer.edit_event', event_id=event.id) }}" class="btn btn--ghost btn--sm">Edit</a>
            </div>
          {% endfor %}
        </div>
      {% endif %}
      <a href="{{ url_for('officer.manage_events') }}" class="btn btn--outline btn--full">
        <i class="fas fa-file-alt" style="width: 1.25rem; height: 1.25rem;"></i>
        Manage All Events
      </a>
    {% endcall %}
  </div>

  <!-- Reports & Analytics -->
  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: var(--space-6);">
    <!-- Reports Card -->
    {% call ui.card(title='Reports', compact=true) %}
      <p style="color: var(--color-gray-600); font-size: var(--text-sm); margin-bottom: var(--space-4);">
        Interactive reports with charts, role-based filtering, and CSV/Excel export.
      </p>
      <a href="{{ url_for('officer.reports') }}" class="btn btn--outline btn--full">
        <i class="fas fa-chart-bar" style="width: 1.25rem; height: 1.25rem;"></i>
        Generate Reports
      </a>
    {% endcall %}

    <!-- Email Logs Card -->
    {% call ui.card(title='Email Logs', compact=true) %}
      <p style="color: var(--color-gray-600); font-size: var(--text-sm); margin-bottom: var(--space-4);">
        View email delivery status and troubleshoot invitation issues.
      </p>
      <a href="{{ url_for('admin.email_logs') }}" class="btn btn--outline btn--full">
        <i class="fas fa-envelope" style="width: 1.25rem; height: 1.25rem;"></i>
        View Email Logs
      </a>
    {% endcall %}

    <!-- Support Tickets Card -->
    {% call ui.card(title='Support Tickets', compact=true) %}
      <p style="color: var(--color-gray-600); font-size: var(--text-sm); margin-bottom: var(--space-4);">
        Manage user support tickets, suggestions, and feedback.
      </p>
      <a href="{{ url_for('tickets.index') }}" class="btn btn--outline btn--full">
        <i class="fas fa-ticket-alt" style="width: 1.25rem; height: 1.25rem;"></i>
        View Tickets
      </a>
    {% endcall %}

    <!-- Volunteer View Card -->
    {% call ui.card(title='Volunteer View', compact=true) %}
      <p style="color: var(--color-gray-600); font-size: var(--text-sm); margin-bottom: var(--space-4);">
        See what volunteers see: browse events and sign up workflows.
      </p>
      <a href="{{ url_for('auth.volunteer_dashboard') }}" class="btn btn--outline btn--full">
        <i class="fas fa-eye" style="width: 1.25rem; height: 1.25rem;"></i>
        View as Volunteer
      </a>
    {% endcall %}
  </div>
</div>
{% endblock %}
